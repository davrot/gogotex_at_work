# Implementation Plan: SSH-only Git authentication for `git-bridge`

**Branch**: `001-ssh-git-auth` | **Date**: 2025-12-10 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/001-ssh-git-auth/spec.md`

## Summary

Replace legacy HTTP/OAuth2 authentication in `git-bridge` with SSH-key-only
authentication. Provide UI for users to add/revoke SSH public keys, validate
SSH keys via the internal web-profile API, and remove deprecated OAuth2/HTTP
authentication components. Ensure observability for authentication events and
retain development/CI compatibility.

## Technical Context

**Language/Version**: Node.js (existing `git-bridge` uses Node/Express) — confirm in codebase
**Primary Dependencies**: `ssh2`/`ssh2-streams` for SSH handling, existing MongoDB client in web-profile service, internal HTTP client for API calls.
**Storage**: MongoDB (user profile service stores SSH public keys)
**Testing**: Mocha/Chai + integration harness using ephemeral SSH server for end-to-end tests
**Target Platform**: Linux containers (Docker)
**Project Type**: Microservice (`services/git-bridge`)
**Performance Goals**: No measurable regression in `git clone`/`git push` p95 latency for small repos (<10MB). Performance tests added to CI.
**Constraints**: Must not expose private keys; use internal authenticated API for key retrieval.
**Scale/Scope**: Support existing user base; expected moderate request volume per instance.

## Constitution Check

GATE: Must satisfy Constitution principles — code quality, testing standards, UX consistency, performance, and observability. Documented in plan sections below.

## Project Structure

### Documentation (this feature)

```text
specs/001-ssh-git-auth/
├── plan.md
├── spec.md
├── checklists/
└── tasks.md (generated by /speckit.tasks)
```

### Source Code (affected areas)

```text
services/git-bridge/            # primary microservice to modify
web/                            # web UI changes for account settings
specs/001-ssh-git-auth/         # docs and tasks
tests/integration/git-bridge/   # integration tests for SSH auth
```

**Structure Decision**: Modify `services/git-bridge` for SSH auth; add UI components under `web` account settings; tests under `tests/integration`.

## Complexity Tracking

| Violation | Why Needed | Simpler Alternative Rejected Because |
|-----------|------------|-------------------------------------|
| Direct DB access by `git-bridge` | Simpler retrieval | Rejected due to security and audit centralization; prefer internal API |
